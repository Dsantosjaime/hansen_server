{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import { AbilityOptions, AbilityTuple, fieldPatternMatcher, PureAbility, RawRuleFrom } from '@casl/ability';\nimport type { Prisma } from '@prisma/client';\n\nimport type { PrismaModel, PrismaQueryFactory, PrismaTypeMap, PrismaTypes } from './runtime';\nimport { createAbilityFactory, prismaQuery } from './runtime';\n\nexport { accessibleBy, ParsingQueryError, prismaQuery } from './runtime';\nexport type * from './runtime';\nexport type WhereInput<TModelName extends Prisma.ModelName> =\n  PrismaTypes<Prisma.TypeMap>['WhereInput'][TModelName];\nexport type PrismaQuery<T extends PrismaModel = PrismaModel> =\n  PrismaQueryFactory<Prisma.TypeMap, T>;\n\nexport function createPrismaAbilityFor<TTypeMap extends PrismaTypeMap<string>>() {\n  return createAbilityFactory<PrismaTypes<TTypeMap>['ModelName'], PrismaQueryFactory<TTypeMap>>();\n}\n\nexport const createPrismaAbility = createPrismaAbilityFor<Prisma.TypeMap>();\n\n/**\n * Uses conditional type to support union distribution\n */\ntype ExtendedAbilityTuple<T extends AbilityTuple> = T extends AbilityTuple\n  ? [T[0], 'all' | T[1]]\n  : never;\n\n/**\n * @deprecated use createPrismaAbility instead\n */\nexport class PrismaAbility<\n  A extends AbilityTuple = [string, Prisma.ModelName],\n  C extends PrismaQuery = PrismaQuery\n> extends PureAbility<ExtendedAbilityTuple<A>, C> {\n  constructor(\n    rules?: RawRuleFrom<ExtendedAbilityTuple<A>, C>[],\n    options?: AbilityOptions<ExtendedAbilityTuple<A>, C>\n  ) {\n    super(rules, {\n      conditionsMatcher: prismaQuery,\n      fieldMatcher: fieldPatternMatcher,\n      ...options,\n    });\n  }\n}\n"],"names":["createPrismaAbilityFor","createAbilityFactory","createPrismaAbility","PrismaAbility","PureAbility","constructor","rules","options","super","Object","assign","conditionsMatcher","prismaQuery","fieldMatcher","fieldPatternMatcher"],"mappings":"uEAaO,SAASA,yBACd,OAAOC,wBACT,CAEO,MAAMC,EAAsBF,yBAY5B,MAAMG,sBAGHC,EAAAA,YACRC,WAAAA,CACEC,EACAC,GAEAC,MAAMF,EAAKG,OAAAC,OAAA,CACTC,kBAAmBC,EAAAA,YACnBC,aAAcC,EAAAA,qBACXP,GAEP"}